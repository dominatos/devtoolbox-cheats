Title: üçÉ MongoDB ‚Äî Cheatsheet
Group: Databases
Icon: üçÉ
Order: 5

# Connect / –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
mongosh "mongodb://user:pass@localhost:27017/admin"                                # Open mongosh / –í–æ–π—Ç–∏ –≤ mongosh

# Basics in mongosh / –ë–∞–∑–∞ –≤ mongosh
show dbs                                                                            # List DBs / –°–ø–∏—Å–æ–∫ –±–∞–∑
use mydb                                                                            # Switch DB / –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –±–∞–∑—É
show collections                                                                    # List collections / –°–ø–∏—Å–æ–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–π
db.items.insertOne({name:"item1", qty:10})                                          # Insert one / –í—Å—Ç–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
db.items.findOne({name:"item1"})                                                    # Find one / –ù–∞–π—Ç–∏ –æ–¥–∏–Ω
db.items.find({qty:{$gt:5}}).limit(5)                                               # Filter+limit / –§–∏–ª—å—Ç—Ä + –ª–∏–º–∏—Ç
db.items.updateOne({name:"item1"}, {$set:{qty:15}})                                 # Update fields / –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—è
db.items.createIndex({name:1}, {unique:true})                                       # Create index / –ò–Ω–¥–µ–∫—Å –ø–æ –ø–æ–ª—é
db.stats()                                                                          # DB stats / –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã
db.items.stats()                                                                     # Coll stats / –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

# Export/Import / –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç
mongoexport --uri="mongodb://user:pass@localhost/mydb" \
  --collection=items --out=items.json                                               # Export JSON / –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
mongoimport --uri="mongodb://user:pass@localhost/mydb" \
  --collection=items --file=items.json --jsonArray                                  # Import JSON array / –ò–º–ø–æ—Ä—Ç –º–∞—Å—Å–∏–≤–∞

# Dump/restore / –î–∞–º–ø/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
mongodump   --uri="mongodb://user:pass@localhost/" -o dump/                         # Dump all DBs / –î–∞–º–ø –≤—Å–µ—Ö –±–∞–∑
mongorestore --uri="mongodb://user:pass@localhost/" dump/                           # Restore from dump / –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

# Service admin / –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status mongod                                                        # Service status / –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
sudo journalctl -u mongod -f                                                        # Follow logs / –õ–æ–≥–∏ (follow)

# Security tips / –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
# 1) use admin; db.createUser({user:"u",pwd:"p",roles:[{role:"root",db:"admin"}]})  # Create user / –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# 2) enable authorization in mongod.conf; restart                                    # –í–∫–ª—é—á–∏—Ç—å authorization; –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å

#test user
use admin
db.getUser("admin")        
db.updateUser("admin", { pwd: "3dinformatica" })


